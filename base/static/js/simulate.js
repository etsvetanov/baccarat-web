var values = [0,2.81,5.61,8.38,11.13,13.85,16.52,19.14,21.71,24.22,26.66,29.03,31.32,33.52,35.64,37.65,39.57,41.39,43.09,44.69,46.17,47.53,48.77,49.89,50.89,51.76,52.5,53.12,53.61,53.98,54.21,54.33,54.32,54.19,53.94,53.57,53.09,52.5,51.8,51,50.1,49.11,48.02,46.86,45.61,44.29,42.91,41.46,39.96,38.41,36.82,35.19,33.53,31.85,30.15,28.44,26.73,25.03,23.33,21.65,20,18.37,16.78,15.23,13.73,12.28,10.89,9.56,8.3,7.11,6,4.97,4.03,3.17,2.41,1.74,1.16,0.69,0.31,0.04,-0.13,-0.2,-0.17,-0.03,0.2,0.54,0.98,1.52,2.15,2.88,3.7,4.61,5.6,6.67,7.82,9.04,10.33,11.68,13.09,14.55,16.06,17.62,19.21,20.83,22.47,24.14,25.81,27.49,29.17,30.85,32.51,34.15,35.77,37.35,38.9,40.41,41.86,43.26,44.6,45.87,47.07,48.2,49.25,50.21,51.08,51.86,52.54,53.12,53.6,53.98,54.25,54.4,54.45,54.39,54.21,53.91,53.51,52.99,52.36,51.61,50.75,49.79,48.71,47.54,46.25,44.87,43.4,41.83,40.17,38.42,36.6,34.7,32.73,30.69,28.6,26.44,24.24,21.99,19.71,17.39,15.05,12.69,10.32,7.93,5.55,3.17,0.81,-1.54,-3.87,-6.16,-8.42,-10.64,-12.82,-14.94,-17,-19,-20.93,-22.79,-24.58,-26.28,-27.9,-29.44,-30.88,-32.23,-33.48,-34.63,-35.68,-36.63,-37.47,-38.21,-38.85,-39.38,-39.8,-40.12,-40.33,-40.44,-40.44,-40.35,-40.16,-39.87,-39.48,-39.01,-38.45,-37.8,-37.08,-36.27,-35.4,-34.45,-33.45,-32.38,-31.26,-30.09,-28.88,-27.63,-26.35,-25.04,-23.71,-22.37,-21.01,-19.65,-18.29,-16.93,-15.59,-14.27,-12.97,-11.69,-10.45,-9.25,-8.09,-6.98,-5.92,-4.91,-3.97,-3.09,-2.28,-1.54,-0.87,-0.28,0.23,0.66,1.01,1.27,1.45,1.54,1.55,1.46,1.29,1.03,0.69,0.25,-0.26,-0.86,-1.54,-2.29,-3.13,-4.03,-5.01,-6.06,-7.16,-8.33,-9.55,-10.83,-12.15,-13.52,-14.92,-16.36,-17.82,-19.31,-20.82,-22.34,-23.87,-25.39,-26.92,-28.44,-29.94,-31.43,-32.89,-34.32,-35.71,-37.07,-38.38,-39.64,-40.85,-41.99,-43.08,-44.1,-45.04,-45.92,-46.71,-47.42,-48.05,-48.59,-49.05,-49.41,-49.68,-49.85,-49.92,-49.9,-49.79,-49.57,-49.26,-48.84,-48.33,-47.73,-47.03,-46.23,-45.35,-44.37,-43.31,-42.16,-40.93,-39.61,-38.23,-36.77,-35.24,-33.65,-32,-30.29,-28.53,-26.73,-24.88,-23,-21.08,-19.14,-17.18,-15.2,-13.2,-11.21,-9.21,-7.22,-5.23,-3.27,-1.32,0.6,2.49,4.35,6.17,7.94,9.66,11.33,12.95,14.5,15.99,17.41,18.76,20.03,21.23,22.35,23.39,24.34,25.22,26,26.7,27.31,27.83,28.27,28.61,28.87,29.05,29.13,29.13,29.05,28.89,28.64,28.32,27.93,27.46,26.93,26.33,25.66,24.94,24.17,23.34,22.47,21.55,20.6,19.61,18.59,17.55,16.49,15.42,14.33,13.24,12.14,11.06,9.98,8.91,7.86,6.83,5.83,4.86,3.93,3.03,2.18,1.38,0.62,-0.08,-0.73,-1.31,-1.84,-2.3,-2.69,-3.02,-3.27,-3.45,-3.56,-3.6,-3.56,-3.45,-3.26,-3,-2.66,-2.25,-1.77,-1.21,-0.59,0.1,0.86,1.69,2.57,3.51,4.51,5.56,6.67,7.81,9,10.23,11.5,12.79,14.11,15.45,16.81,18.19,19.57,20.96,22.35,23.73,25.1,26.46,27.8,29.12,30.41,31.67,32.89,34.07,35.21,36.3,37.34,38.32,39.25,40.11,40.9,41.63,42.29,42.87,43.38,43.81,44.16,44.43,44.62,44.73,44.75,44.69,44.55,44.32,44,43.61,43.13,42.57,41.92,41.21,40.41,39.54,38.6,37.58,36.5,35.36,34.15,32.89,31.57,30.2,28.79,27.33,25.83,24.29,22.73,21.14,19.52,17.89,16.25,14.59,12.94,11.28,9.63,7.98,6.35,4.74,3.14,1.58,0.04,-1.46,-2.93,-4.36,-5.76,-7.11,-8.42,-9.67,-10.87,-12.02,-13.11,-14.13,-15.1,-15.99,-16.82,-17.58,-18.27,-18.88,-19.43,-19.9,-20.29,-20.61,-20.85,-21.02,-21.12,-21.14,-21.09,-20.98,-20.79,-20.53,-20.21,-19.82,-19.37,-18.87,-18.31,-17.69,-17.03,-16.32,-15.57,-14.78,-13.95,-13.1,-12.21,-11.31,-10.38,-9.44,-8.49,-7.53,-6.57,-5.62,-4.67,-3.74,-2.81,-1.91,-1.04,-0.19,0.62,1.4,2.14,2.83,3.48,4.07,4.61,5.1,5.52,5.89,6.18,6.41,6.57,6.67,6.68,6.63,6.5,6.3,6.02,5.67,5.24,4.73,4.16,3.5,2.78,1.99,1.12,0.19,-0.8,-1.86,-2.98,-4.15,-5.38,-6.66,-7.98,-9.35,-10.76,-12.21,-13.68,-15.18,-16.71,-18.25,-19.81,-21.37,-22.94,-24.51,-26.08,-27.63,-29.17,-30.69,-32.18,-33.64,-35.07,-36.47,-37.81,-39.11,-40.36,-41.55,-42.69,-43.76,-44.76,-45.69,-46.55,-47.33,-48.03,-48.64,-49.18,-49.62,-49.98,-50.25,-50.43,-50.51,-50.51,-50.41,-50.21,-49.92,-49.54,-49.07,-48.51,-47.85,-47.11,-46.29,-45.37,-44.38,-43.31,-42.16,-40.93,-39.64,-38.28,-36.86,-35.38,-33.84,-32.26,-30.63,-28.95,-27.24,-25.5,-23.74,-21.95,-20.14,-18.32,-16.49,-14.67,-12.84,-11.03,-9.23,-7.45,-5.69,-3.96,-2.26,-0.6,1.01,2.58,4.1,5.56,6.97,8.31,9.59,10.79,11.93,12.99,13.97,14.88,15.7,16.44,17.1,17.67,18.16,18.56,18.87,19.1,19.24,19.3,19.28,19.17,18.98,18.71,18.36,17.94,17.45,16.89,16.26,15.57,14.82,14.02,13.17,12.27,11.32,10.34,9.33,8.29,7.23,6.14,5.05,3.94,2.84,1.73,0.64,-0.45,-1.52,-2.56,-3.58,-4.56,-5.51,-6.41,-7.27,-8.08,-8.83,-9.52,-10.15,-10.71,-11.21,-11.62,-11.97,-12.23,-12.41,-12.51,-12.52,-12.45,-12.29,-12.03,-11.69,-11.26,-10.74,-10.13,-9.42,-8.63,-7.76,-6.79,-5.75,-4.62,-3.41,-2.12,-0.77,0.66,2.16,3.72,5.34,7.01,8.73,10.5,12.31,14.15,16.03,17.93,19.86,21.79,23.74,25.69,27.63,29.57,31.5,33.41,35.29,37.14,38.95,40.72,42.45,44.12,45.74,47.29,48.77,50.19,51.52,52.78,53.95,55.04,56.03,56.92,57.72,58.42,59.02,59.51,59.89,60.17,60.34,60.4,60.35,60.18,59.91,59.53,59.04,58.45,57.74,56.94,56.03,55.03,53.93,52.74,51.46,50.09,48.64,47.12,45.52,43.85,42.13,40.34,38.5,36.61,34.68,32.72,30.73,28.71,26.67,24.62,22.56,20.51,18.46,16.42,14.4,12.4,10.43,8.49,6.6,4.75,2.95,1.21,-0.48,-2.09,-3.64,-5.12,-6.51,-7.83,-9.06,-10.2,-11.26,-12.22,-13.08,-13.86,-14.53,-15.1,-15.58,-15.95,-16.23,-16.4,-16.48,-16.46,-16.34,-16.13,-15.83,-15.43,-14.95,-14.39,-13.74,-13.02,-12.22,-11.35,-10.42,-9.42,-8.37,-7.27,-6.13,-4.94,-3.72,-2.48,-1.21,0.08,1.38,2.69,3.99,5.28,6.57,7.83,9.06,10.27,11.44,12.56,13.64,14.66,15.63,16.53,17.36,18.11,18.79,19.39,19.9,20.32,20.64,20.87,21,21.03,20.95,20.77,20.48,20.09,19.59,18.98,18.26,17.43,16.49,15.45,14.31,13.06,11.72,10.28,8.74,7.11,5.4,3.6,1.72,-0.23,-2.25,-4.33,-6.48,-8.67,-10.92,-13.2,-15.52,-17.87,-20.25,-22.63,-25.03,-27.43,-29.83,-32.22,-34.58,-36.93,-39.24,-41.52,-43.75,-45.93,-48.06,-50.12,-52.11,-54.02,-55.86,-57.61,-59.27,-60.83,-62.3,-63.66,-64.91,-66.04,-67.06,-67.97,-68.75,-69.4,-69.94,-70.34,-70.62,-70.76,-70.78,-70.67,-70.43,-70.06,-69.57,-68.95,-68.21,-67.34,-66.36,-65.27,-64.06,-62.75,-61.33,-59.81,-58.2,-56.5,-54.72,-52.86,-50.93,-48.93,-46.87,-44.76,-42.6,-40.4,-38.17,-35.91,-33.63,-31.34,-29.04,-26.74,-24.46,-22.18,-19.93,-17.71,-15.53,-13.39,-11.29,-9.26,-7.28,-5.37,-3.53,-1.77,-0.09,1.5,3]

var chartData={
    "type":"line",  // Specify your chart type here.
    "background-color":"#f4f4f4",
    "scale-x": {
        "zooming":true
    },
    "plot": {
        "mode":"fast",
        "exact":true,
        "smartSampling":true,
        "maxNodes":0,
        "maxTrackers":0,
        "lineWidth":2,
        "shadow":false,
        "marker":{
            "type":"none",
            "shadow":false
        }
    },
    "plotarea":{
        "background-color":"#fbfbfb",
        "margin-top":"30px",
        "margin-bottom":"40px",
        "margin-left":"50px",
        "margin-right":"30px"
    },
    "scaleX":{
        "autoFit":true,
        "zooming":true,
        "normalize":true,
        "lineWidth":1,
        "line-color":"#c7c9c9",
        "tick":{
            "lineWidth":1,
            "line-color":"#c7c9c9"
        },
        "guide":{
            "visible":false
        },
        "item":{
            "font-color":"#818181",
            "font-family":"Arial",
            "padding-top":"5px"
        },
        "maxLabels":10
    },
    "scrollX":{ },
    "scaleY":{
        "minValue":"auto",
        "autoFit":true,
        "lineWidth":1,
        "line-color":"#c7c9c9",
        "tick":{
            "lineWidth":1,
            "line-color":"#c7c9c9"
        },
        "item":{
            "font-color":"#818181",
            "font-family":"Arial",
            "padding-right":"5px"
        },
        "guide":{
            "lineStyle":"solid",
            "line-color":"#c7c9c9",
            "alpha":0.2
        }
    },
    "tooltip":{
        "visible":false
    },
    "crosshairX":{
        "lineWidth":1,
        "line-color":"#003849",
        "marker":{
            "size":4,
            "type":"circle",
            "borderColor":"#fff",
            "borderWidth":1
        },
        "scale-label":{
            "font-color":"#ffffff",
            "background-color":"#003849",
            "padding":"5px 10px 5px 10px",
            "border-radius":"5px"
        },
//            "plotLabel":{
//                "multiple":false,
//                "callout":false,
//                "shadow":false,
//                "height":"115px",
//                "padding":"5px 10px 5px 10px",
//                "border-radius":"5px",
//                "alpha":1,
//                "headerText":"Node %scale-key-text<br>",
//                "text":"<b>%plot-text:</b> %node-value"
//            }
    },

    "series":[  // Insert your series data here.
        {   "text": "P1",
            "values": values,
            "line-color":"#7ca82b",
            "line-width":1
        },
    ]
};

var selected_iter = null;

$(document).ready(function() {

    socket = new WebSocket("ws://" + window.location.host + "/simulate/");

    socket.onmessage = function (event) {
        var msg = JSON.parse(event.data);
        var percentage = msg.percentage;
        console.log("percentage", percentage)
        $('#id_progress_bar').attr('style', 'width: ' + percentage + '%;');
        $('#id_progress_bar').attr('aria-valuenow', percentage);

        if(percentage == 100) {
            console.log("Showing the graph")
            $('#id_graph_box').html('');
            zingchart.render({ // Render Method[3]
                id:'id_graph_box',
                data:chartData,
                height:400,
                width:800,
            });

            zingchart.guide_mousemove=function(p) {
                selected_iter = p['scale-label']['scale-x'];
//                console.log("GRAPH CLICKEND ON X:", p['scale-label']['scale-x']);
//                console.log('position:', p.guide.x)
            };

            zingchart.click=function(p){
                console.log('Selected iteration is:', selected_iter);
            };
        }
    }
});
